"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8073],{5961:(P,p,s)=>{s.d(p,{GW:()=>g,dk:()=>i,oK:()=>h});var h=function(r){return r.Prompt="PROMPT",r.Camera="CAMERA",r.Photos="PHOTOS",r}(h||{}),g=function(r){return r.Rear="REAR",r.Front="FRONT",r}(g||{}),i=function(r){return r.Uri="uri",r.Base64="base64",r.DataUrl="dataUrl",r}(i||{})},8073:(P,p,s)=>{s.r(p),s.d(p,{FinishWorkoutPageModule:()=>U});var h=s(6814),g=s(95),i=s(1929),r=s(335),f=s(5861),Z=s(2726),k=s(5961);const T=(0,Z.fo)("Camera",{web:()=>s.e(6468).then(s.bind(s,6468)).then(e=>new e.CameraWeb)});var o=s(6689),W=s(5694),b=s(3185);function A(e,l){if(1&e&&(o.TgZ(0,"ion-item"),o._UZ(1,"ion-img",13),o.qZA()),2&e){const c=o.oxw();o.xp6(1),o.Q6J("src",c.photo.webPath)}}const F=[{path:"",component:(()=>{var e;class l{constructor(n,t,u,a){this.route=n,this.router=t,this.selectedExercisesService=u,this.userExerciseService=a,this.workoutTitle="",this.description="",this.duration="",this.volume=0,this.sets=0,this.photo=null}ngOnInit(){const n=this.router.getCurrentNavigation(),t=null==n?void 0:n.extras.state;var u,a;t?(this.volume=null!==(u=t.volume)&&void 0!==u?u:0,this.sets=null!==(a=t.sets)&&void 0!==a?a:0,this.duration=t.duration,this.userId=t.userId):console.error("State object is missing in navigation extras."),console.log("State object received:",t)}getCurrentTimestamp(){return(new Date).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}saveWorkout(n){var t=this;return(0,f.Z)(function*(){const u=t.selectedExercisesService.getSelectedExercises().map(d=>{var m,v;return{name:d.Name,sets:null!==(m=d.setsCounter)&&void 0!==m?m:1,reps:null!==(v=d.reps)&&void 0!==v?v:0}}),a={userId:t.userId,workoutTitle:t.workoutTitle,description:t.description,duration:t.duration,volume:t.volume,sets:t.sets,timestamp:t.getCurrentTimestamp(),exercises:u};n&&(a.photoURL=n);try{yield t.userExerciseService.saveWorkout(a),console.log("Workout saved successfully"),t.router.navigate(["/home"])}catch(d){console.error("Error saving workout:",d)}})()}discardWorkout(){window.confirm("Are you sure you want to discard this workout?")&&this.router.navigate(["/home"])}takeOrSelectPhoto(){var n=this;return(0,f.Z)(function*(){try{const t=yield T.getPhoto({resultType:k.dk.Uri,source:k.oK.Prompt,quality:90});n.uploadPhoto(t)}catch(t){console.error("Error taking or selecting photo:",t)}})()}uploadPhoto(n){var t=this;return(0,f.Z)(function*(){try{const a=yield(yield fetch(n.webPath)).blob(),d=`image-${(new Date).getTime()}.${n.format}`,m=yield t.userExerciseService.uploadImage(a,d);t.saveWorkout(m)}catch(u){console.error("Error uploading photo:",u)}})()}}return(e=l).\u0275fac=function(n){return new(n||e)(o.Y36(r.gz),o.Y36(r.F0),o.Y36(W.J),o.Y36(b.A))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-finish-workout"]],decls:46,vars:7,consts:[["slot","start"],["slot","end"],[3,"click"],["color","danger",3,"click"],["position","floating"],[3,"ngModel","ngModelChange"],["lines","full"],["fill","outline",3,"click"],["slot","start","name","camera"],[4,"ngIf"],["lines","none"],[1,"ion-text-wrap",2,"color","#3880ff"],["slot","end",2,"color","#3880ff","font-weight","bold"],[3,"src"]],template:function(n,t){1&n&&(o.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),o._UZ(3,"ion-back-button"),o.qZA(),o.TgZ(4,"ion-title"),o._uU(5,"Finish Workout"),o.qZA(),o.TgZ(6,"ion-buttons",1)(7,"ion-button",2),o.NdJ("click",function(){return t.saveWorkout()}),o._uU(8,"Save"),o.qZA(),o.TgZ(9,"ion-button",3),o.NdJ("click",function(){return t.discardWorkout()}),o._uU(10,"Discard"),o.qZA()()()(),o.TgZ(11,"ion-content")(12,"ion-list")(13,"ion-item")(14,"ion-label",4),o._uU(15,"Workout title"),o.qZA(),o.TgZ(16,"ion-input",5),o.NdJ("ngModelChange",function(a){return t.workoutTitle=a}),o.qZA()(),o.TgZ(17,"ion-item")(18,"ion-label"),o._uU(19,"Duration"),o.qZA(),o.TgZ(20,"ion-note"),o._uU(21),o.qZA()(),o.TgZ(22,"ion-item")(23,"ion-label"),o._uU(24,"Volume"),o.qZA(),o.TgZ(25,"ion-note"),o._uU(26),o.qZA()(),o.TgZ(27,"ion-item")(28,"ion-label"),o._uU(29,"Sets"),o.qZA(),o.TgZ(30,"ion-note"),o._uU(31),o.qZA()(),o.TgZ(32,"ion-item")(33,"ion-label",4),o._uU(34,"Description"),o.qZA(),o.TgZ(35,"ion-textarea",5),o.NdJ("ngModelChange",function(a){return t.description=a}),o.qZA()(),o.TgZ(36,"ion-item",6)(37,"ion-button",7),o.NdJ("click",function(){return t.takeOrSelectPhoto()}),o._UZ(38,"ion-icon",8),o._uU(39," Add Photo "),o.qZA()(),o.YNc(40,A,2,1,"ion-item",9),o.TgZ(41,"ion-item",10)(42,"ion-label",11),o._uU(43,"When"),o.qZA(),o.TgZ(44,"ion-note",12),o._uU(45),o.qZA()()()()),2&n&&(o.xp6(16),o.Q6J("ngModel",t.workoutTitle),o.xp6(5),o.Oqu(t.duration),o.xp6(5),o.Oqu(t.volume),o.xp6(5),o.Oqu(t.sets),o.xp6(4),o.Q6J("ngModel",t.description),o.xp6(5),o.Q6J("ngIf",t.photo),o.xp6(5),o.Oqu(t.getCurrentTimestamp()))},dependencies:[h.O5,g.JJ,g.On,i.YG,i.Sm,i.W2,i.Gu,i.gu,i.Xz,i.pK,i.Ie,i.Q$,i.q_,i.uN,i.g2,i.wd,i.sr,i.j9,i.oU],styles:["ion-content[_ngcontent-%COMP%]{--background: #fff}ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0;--inner-padding-start: 0;--padding-end: 0;--border-color: #e0e0e0;--border-style: solid;--border-width: 0 0 1px 0}ion-input[_ngcontent-%COMP%], ion-textarea[_ngcontent-%COMP%], ion-note[_ngcontent-%COMP%]{--padding-start: 16px;--padding-end: 16px;width:100%;font-size:1em}ion-label[_ngcontent-%COMP%]{--color: #000}ion-button[_ngcontent-%COMP%]{margin:20px 0;font-weight:500}ion-toolbar[_ngcontent-%COMP%]{--background: #f8f8f8}ion-title[_ngcontent-%COMP%]{text-align:center}"]}),l})()}];let M=(()=>{var e;class l{}return(e=l).\u0275fac=function(n){return new(n||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[r.Bz.forChild(F),r.Bz]}),l})(),U=(()=>{var e;class l{}return(e=l).\u0275fac=function(n){return new(n||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[h.ez,g.u5,i.Pc,M]}),l})()}}]);